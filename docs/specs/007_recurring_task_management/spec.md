---
Title: 繰り返しタスク設定
Status: Ready
Created: 2026-02-11
Last updated: 2026-02-11
Source: ../000_backlog/recurring-task-management.md
---

# 繰り返しタスク設定

## Goal

定期的に発生するタスクを繰り返しルールで継続管理できるようにし、再登録の手間と対応漏れを減らす。

## Non-goals

- カスタム複雑ルール（例: 毎月第3火曜日、隔週など）の提供。
- リマインダー通知や外部カレンダー連携。
- 繰り返しタスクのカンバン表示や進捗ステージ管理。
- チーム共有タスク・担当者アサイン。

## User Scenarios & Testing

- Given タスク作成画面を開いている, When ユーザーが繰り返し種別を「日次」に設定して保存する, Then タスクは繰り返しタスクとして保存される。
- Given 繰り返し「週次」の未完了タスクがある, When ユーザーがそのタスクを完了にする, Then 同じ内容の次回タスクが未完了で1件生成される。
- Given 繰り返しタスクがある, When ユーザーが繰り返し設定を「なし」に変更して保存する, Then 以後そのタスクを完了しても次回タスクは生成されない。
- Given 繰り返し「月次」で 2026-01-31 を期限に持つタスクがある, When そのタスクを完了にする, Then 次回タスクの期限は 2026-02-28（うるう年は2月29日）になる。
- Given 期限日を過ぎた繰り返しタスクがある, When ユーザーが完了にする, Then 次回期限は完了操作日の基準で計算される。
- Given 他ユーザーの繰り返しタスクIDを指定して更新操作する, When APIを呼び出す, Then 認可エラーで拒否される。

## Edge Cases

- 同一タスクに対して完了操作が重複送信されても、次回タスクの生成は1件にとどまる。
- 月次繰り返しで該当日が存在しない月は、その月の末日を期限日として扱う。
- 期限日未設定のタスクは繰り返し設定を有効化できない。
- 繰り返し設定変更は保存後の次回生成分から適用され、既存の過去タスクには遡及しない。
- 繰り返し設定済みタスクが削除された場合、そのタスク起点での次回生成は行われない。

## Requirements

### Functional Requirements

- FR-001: ユーザーはタスク作成・編集時に繰り返し設定（なし/日次/週次/月次）を指定できなければならない (MUST)。
- FR-002: 繰り返し設定を有効化する場合、期限日を必須としなければならない (MUST)。
- FR-003: タスク一覧および編集画面で、繰り返し設定の有無と種別を識別できなければならない (MUST)。
- FR-004: 繰り返し設定されたタスクが未完了から完了へ遷移したとき、次回タスクを1件だけ自動生成しなければならない (MUST)。
- FR-005: 次回タスクは、元タスクの所有者・タスク名・詳細・繰り返し種別を引き継ぎ、完了状態は未完了でなければならない (MUST)。
- FR-006: 次回期限日の計算は完了操作日を基準とし、日次は+1日、週次は+7日、月次は翌月同日（存在しない場合は月末）としなければならない (MUST)。
- FR-007: 完了済みの元タスクは履歴として保持され、次回生成後も完了状態のまま参照できなければならない (MUST)。
- FR-008: ユーザーは既存タスクの繰り返し設定を変更または解除できなければならない (MUST)。
- FR-009: 繰り返し設定を解除したタスクでは、解除後の完了操作で次回タスクを生成してはならない (MUST)。
- FR-010: 同一タスクへの重複完了操作や再送があっても、同一サイクルで複数の次回タスクを生成してはならない (MUST)。
- FR-011: 同一シリーズのタスクは同名で継続生成できなければならない (MUST)。
- FR-012: 繰り返し設定の作成・更新・削除・完了操作はタスク所有者のみ実行できなければならない (MUST)。

### Non-functional Requirements

- NFR-001: 繰り返しタスクの完了操作後、次回タスクの表示更新は1秒以内に反映されるか、進行中であることを明示しなければならない (SHOULD)。
- NFR-002: 次回期限日の計算は日付（YYYY-MM-DD）単位で決定論的に処理され、時刻情報の有無で結果が変わってはならない (MUST)。
- NFR-003: 次回生成の重複防止は、同一リクエスト再送時でも一貫して成立しなければならない (MUST)。

## Open Questions

- なし
